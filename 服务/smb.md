# SMB

\[TOC]

## 引言

* SMB ： 网络文件共享系统，一种应用层网络传输协议，主要功能是使网络上的机器可以共享计算机文件、打印机、串行端口和通讯等资源，也提供经过认证的进程间通信技能
* 使用 C/S 架构，工作端口：
  * \\\共享计算机地址\资源路径 ： 使用 TCP 协议，445 端口
  * \\\共享计算机名\资源路径 : 使用 NetBIOS 协议， 139 端口
* SMB 工作流程： 版本协商--> 会话请求凭据 --> 文件路径凭据 --> 对共享资源进行操作

### 1. 使用 TCP 协议

我们可以看到 189 192 193 是在建立 TCP 连接， 第 194 197 198 是一个版本协商的过程，第 199 200 201 202 是在处理远程登陆凭据， 第一次连接错误，第二次正确， 203 205 是在处理远程文件路径的凭据



![image-20221106091405491](https://typora-1311404666.cos.ap-beijing.myqcloud.com/img/20221106130120.png)

### 2. 使用 NETBIOS 协议

> 自己电脑无法使用计算机名称访问
